From ed0bfa7c303b2975d91b959c4e5cd948555f4d94 Mon Sep 17 00:00:00 2001
From: OpenEmbedded <oe.patch@oe>
Date: Wed, 7 Dec 2022 11:13:32 +0800
Subject: [PATCH 1/1] force-spi-to-run-at-single-mode

---
 drivers/mtd/spi-nor/controllers/aspeed-smc.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/mtd/spi-nor/controllers/aspeed-smc.c b/drivers/mtd/spi-nor/controllers/aspeed-smc.c
index b96304a298ab..7612dafa637a 100644
--- a/drivers/mtd/spi-nor/controllers/aspeed-smc.c
+++ b/drivers/mtd/spi-nor/controllers/aspeed-smc.c
@@ -20,6 +20,8 @@
 
 #define DEVICE_NAME	"aspeed-smc"
 
+const char *match_compatible = NULL;
+
 /*
  * The driver only support SPI flash
  */
@@ -883,6 +885,7 @@ static int aspeed_smc_probe(struct platform_device *pdev)
 	if (!match || !match->data)
 		return -ENODEV;
 	info = match->data;
+    match_compatible = match->compatible;
 
 	controller = devm_kzalloc(&pdev->dev,
 				  struct_size(controller, chips, info->nce),
-- 
2.25.1

